<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu de Câbles - Connexions Parfaites</title>
    <style>
        @font-face {
            font-family: 'Astonpoliz';
            src: url('../assets/Font/Astonpoliz.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #0A022D;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-image: url("../assets/images/SystemeComCadre.svg"),
                url('../assets/images/FondCercles.svg');
            background-repeat: no-repeat;
            background-position: center;
            overflow-y: hidden;
            overflow-x: hidden;
        }

        .Content {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;

        }

        .Game {
            display: flex;
            flex-direction: row;
            gap: 60px;
            margin-bottom: 40px;
        }

        .Instructions {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 80px;
        }


        .game-container {
            display: grid;
            grid-template-columns: repeat(5, 80px);
            grid-template-rows: repeat(5, 80px);
            gap: 65px;
        }

        .cell {
            width: 140px;
            height: 140px;
            background-color: transparent;
            border: 2px solid #4DADAC;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
        }

        .battery {
            background-color: #FF5722;
            font-weight: bold;
        }

        .shield {
            background-color: #F00E1326;
            font-weight: bold;
        }

        .wire {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wire img {
            max-width: 100%;
            max-height: 100%;
            transition: transform 0.3s ease;
        }

        .status {
            margin-top: 70px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            width: 100%;
            max-width: 400px;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .powered {
            background-color: rgba(76, 175, 80, 0.3);
        }

        .container {
            position: relative;
            display: inline-block;
            padding: 10px;
        }

        .blur-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(244, 171, 84, 0.5);
            /* Couleur similaire au fond */
            filter: blur(105px);
            z-index: -1;
            top: 35px;
            left: 35px;
            right: 35px;
            bottom: 35px;
        }

        .text {
            position: relative;
            color: #F4AB54;
            font-size: 1.4em;
            text-align: center;
            font-family: 'Astonpoliz';
        }

        .container2 {
            position: relative;
            display: inline-block;
            padding: 10px;
        }


        .blur-bg2 {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(49, 255, 147, 0.5);
            /* Couleur similaire au fond */
            filter: blur(105px);
            z-index: -1;

        }

        .text2 {
            color: #31FF93;
            font-family: 'Astonpoliz';
            font-size: 1.1em;
            margin-bottom: 20px;
        }


        .end-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(10, 2, 45, 100);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease;
            background-image: url("../assets/images/SystemeComCadre.svg"),
                url('../assets/images/FondCercles.svg');
            background-repeat: no-repeat;
            background-position: center;

        }

        .end-screen.show {
            display: flex;
            opacity: 1;
        }

        .end-screen-content {
            text-align: center;

        }

        .end-screen h1 {
            color: #31FF93;
            font-family: 'Astonpoliz';
            font-size: 5.3em;
            margin-bottom: 20px;
        }

        /* 
        .end-screen button {
            background-color: #4DADAC;
            color: #0A022D;
            font-size: 1.2em;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        } */

        .end-screen button:hover {
            background-color: #3D8D8C;
        }

        #SoundBar {
            position: absolute;
            bottom: 75px;
            right: 1120px;
            height: 100px;
            width: 550px;

        }

        #Circle {
            position: absolute;
            bottom: 810px;
            right: 1100px;
            height: 130px;
            width: 550px;
        }

        #linkToEnterCode{
            animation: zoom-in-zoom-out 2s ease infinite;
        }

        #linkSuccess {
            color: #31FF93;
            font-family: 'Astonpoliz';
            font-size: 1.5em;
            text-decoration: none;
            margin-top: 20px;
            
        }

        @keyframes zoom-in-zoom-out {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

    </style>
</head>

<body>
    <div class="Content">
        <div class="Game">
            <div class="Instructions">

                <div id="instructions">
                    <div class="container">
                        <div class="blur-bg"></div>
                        <div class="text">
                            <h1>vous devez reconnecter les<br>deux extrémités du<br>courant en tournant les<br>
                                différentes
                                pièces</h1>
                        </div>
                    </div>
                </div>
            </div>
            <div id="image">
                <img id="SoundBar" src="../assets/images/SoundBar.svg" alt="">
                <img id="Circle" src="../assets/images/Circle.svg" alt="">
            </div>
            <div class="GameContent">
                <div class="game-container" id="gameGrid"></div>
                <div class="status" id="status"></div>
                <!-- <div>
                    <button id="resetBtn">RÉINITIALISER</button>
                    <button id="newGameBtn">NOUVEAU JEU</button>
                </div> -->
            </div>
        </div>
    </div>

    <div class="end-screen" id="endScreen">

        <div class="end-screen-content">
            <div class="container2">
                <div class="blur-bg2"></div>
                <div class="text2">
                    <h1>SYSTÈME DE COMMUNICATION ACTIVÉ</h1>
                </div>
                <div id="linkToEnterCode">
                    <a id="linkSuccess" href="../pages/ValidationCode.html">Appuyer pour entrer le code de validation</a>
                </div>
            </div>
            <!-- <button id="restartButton">Rejouer</button> -->
        </div>
    </div>

    <script>
        // Encodage des SVG en base64
        const horizontalCableSVG = `data:image/svg+xml;base64,${btoa(`<svg width="151" height="153" viewBox="0 0 151 153" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M46.5587 8.5H104.441L141.5 47.2445V104.763L104.43 144.5H46.5697L8.5 104.751V47.256L46.5587 8.5Z" fill="url(#paint0_radial_140_189)" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter0_f_140_189)"><path d="M56.0406 30.75H95.6466L121 57.512V97.2985L95.6355 124.75H56.0517L30 97.2871V57.5234L56.0406 30.75Z" stroke="#4DADAC" stroke-width="3"/></g><path d="M96.2918 29.25L122.5 56.9143V97.8854L96.2918 126.25H55.4071L28.5 97.8854V56.9143L55.4071 29.25H96.2918Z" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter1_f_140_189)"><circle cx="75.5" cy="77.25" r="22" transform="rotate(90 75.5 77.25)" stroke="#4DADAC" stroke-width="2"/></g><circle cx="75.5" cy="77.25" r="23" transform="rotate(90 75.5 77.25)" stroke="#4DADAC" stroke-width="2"/><g filter="url(#filter2_f_140_189)"><path d="M46.0587 8.75H103.941L141 47.4945V105.013L103.93 144.75H46.0697L8 105.001V47.506L46.0587 8.75Z" stroke="#4DADAC" stroke-width="3"/></g><g filter="url(#filter3_d_140_189)"><mask id="path-7-outside-1_140_189" maskUnits="userSpaceOnUse" x="8.5" y="66.25" width="133" height="22" fill="black"><rect fill="white" x="8.5" y="66.25" width="133" height="22"/><path fill-rule="evenodd" clip-rule="evenodd" d="M140.5 67.25V87.25H123.646L123.629 87.25C123.082 87.2457 122.641 86.804 122.636 86.2579L122.636 86.24V83.25H27.3805V71.25H122.636V68.26L122.636 68.2421C122.641 67.696 123.082 67.2543 123.629 67.25L123.646 67.25H140.5ZM26.3636 67.25C26.9159 67.25 27.3636 67.6977 27.3636 68.25V86.25C27.3636 86.8023 26.9159 87.25 26.3636 87.25H9.50002V67.25H26.3636Z"/></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M140.5 67.25V87.25H123.646L123.629 87.25C123.082 87.2457 122.641 86.804 122.636 86.2579L122.636 86.24V83.25H27.3805V71.25H122.636V68.26L122.636 68.2421C122.641 67.696 123.082 67.2543 123.629 67.25L123.646 67.25H140.5ZM26.3636 67.25C26.9159 67.25 27.3636 67.6977 27.3636 68.25V86.25C27.3636 86.8023 26.9159 87.25 26.3636 87.25H9.50002V67.25H26.3636Z" fill="url(#paint1_linear_140_189)"/><path d="M140.5 87.25V87.75H141V87.25H140.5ZM140.5 67.25H141V66.75H140.5V67.25ZM123.646 87.25L123.646 87.75H123.646V87.25ZM123.629 87.25L123.625 87.75L123.628 87.75L123.629 87.25ZM122.636 86.2579L122.136 86.2587L122.136 86.2618L122.636 86.2579ZM122.636 86.24H122.136V86.2409L122.636 86.24ZM122.636 83.25H123.136V82.75H122.636V83.25ZM27.3805 83.25H26.8805V83.75H27.3805V83.25ZM27.3805 71.25V70.75H26.8805V71.25H27.3805ZM122.636 71.25V71.75H123.136V71.25H122.636ZM122.636 68.26L122.136 68.2591V68.26H122.636ZM122.636 68.2421L122.136 68.2382L122.136 68.2413L122.636 68.2421ZM123.629 67.25L123.628 66.75L123.625 66.75L123.629 67.25ZM123.646 67.25V66.75L123.646 66.75L123.646 67.25ZM9.50002 87.25H9.00002V87.75H9.50002V87.25ZM9.50002 67.25V66.75H9.00002V67.25H9.50002ZM141 87.25V67.25H140V87.25H141ZM123.646 87.75H140.5V86.75H123.646V87.75ZM123.628 87.75L123.646 87.75L123.647 86.75L123.629 86.75L123.628 87.75ZM122.136 86.2618C122.143 87.081 122.805 87.7435 123.625 87.75L123.632 86.75C123.359 86.7478 123.139 86.527 123.136 86.2539L122.136 86.2618ZM122.136 86.2409L122.136 86.2587L123.136 86.257L123.136 86.2391L122.136 86.2409ZM122.136 83.25V86.24H123.136V83.25H122.136ZM122.636 82.75H27.3805V83.75H122.636V82.75ZM27.8805 83.25V71.25H26.8805V83.25H27.8805ZM27.3805 71.75H122.636V70.75H27.3805V71.75ZM122.136 68.26V71.25H123.136V68.26H122.136ZM122.136 68.2413L122.136 68.2591L123.136 68.2609L123.136 68.243L122.136 68.2413ZM123.625 66.75C122.805 66.7565 122.143 67.419 122.136 68.2382L123.136 68.2461C123.139 67.973 123.359 67.7522 123.632 67.75L123.625 66.75ZM123.646 66.75L123.628 66.75L123.629 67.75L123.647 67.75L123.646 66.75ZM140.5 66.75H123.646V67.75H140.5V66.75ZM27.8636 68.25C27.8636 67.4216 27.1921 66.75 26.3636 66.75V67.75C26.6398 67.75 26.8636 67.9739 26.8636 68.25H27.8636ZM27.8636 86.25V68.25H26.8636V86.25H27.8636ZM26.3636 87.75C27.1921 87.75 27.8636 87.0784 27.8636 86.25H26.8636C26.8636 86.5261 26.6398 86.75 26.3636 86.75V87.75ZM9.50002 87.75H26.3636V86.75H9.50002V87.75ZM9.00002 67.25V87.25H10V67.25H9.00002ZM26.3636 66.75H9.50002V67.75H26.3636V66.75Z" fill="#4DADAC" mask="url(#path-7-outside-1_140_189)"/></g><g filter="url(#filter4_f_140_189)"><line x1="142" y1="77.3975" x2="9.00038" y2="77.5008" stroke="#88DEB1"/></g><line x1="41.8536" y1="42.8964" x2="51.8536" y2="52.8964" stroke="#4DADAC"/><circle cx="51.5" cy="52.25" r="2" transform="rotate(90 51.5 52.25)" fill="#4DADAC"/><line x1="141" y1="77" x2="9" y2="77" stroke="#88DEB1" stroke-width="4"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(0.707107 -0.707107 -0.707107 -0.707107 41.5 111.25)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(0 -1 -1 0 53.5 104.25)" fill="#4DADAC"/><line x1="109.146" y1="111.604" x2="99.1464" y2="101.604" stroke="#4DADAC"/><circle cx="99.5" cy="102.25" r="2" transform="rotate(-90 99.5 102.25)" fill="#4DADAC"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(-0.707107 0.707107 0.707107 0.707107 109.5 43.25)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(0 1 1 0 97.5 50.25)" fill="#4DADAC"/><defs><filter id="filter0_f_140_189" x="24.5" y="25.25" width="102" height="105" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_189"/></filter><filter id="filter1_f_140_189" x="48.5" y="50.25" width="54" height="54" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_189"/></filter><filter id="filter2_f_140_189" x="0.0999999" y="0.85" width="148.8" height="151.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="3.2" result="effect1_foregroundBlur_140_189"/></filter><filter id="filter3_d_140_189" x="5" y="62.75" width="140" height="29" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix type="matrix" values="0 0 0 0 0.301961 0 0 0 0 0.678431 0 0 0 0 0.67451 0 0 0 1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_140_189"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_140_189" result="shape"/></filter><filter id="filter4_f_140_189" x="0.6" y="68.4975" width="149.801" height="17.9033" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="4.2" result="effect1_foregroundBlur_140_189"/></filter><radialGradient id="paint0_radial_140_189" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(74.5 76.25) rotate(180) scale(239 244.272)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient><linearGradient id="paint1_linear_140_189" x1="121.148" y1="87.25" x2="120.644" y2="62.7502" gradientUnits="userSpaceOnUse"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></linearGradient></defs></svg>`)}`;

        const verticalCableSVG = `data:image/svg+xml;base64,${btoa(`<svg width="153" height="151" viewBox="0 0 153 151" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 104.441V46.5592L47.2445 9.5H104.763L144.5 46.5703V104.43L104.751 142.5H47.256L8.5 104.441Z" fill="url(#paint0_radial_140_21)" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter0_f_140_21)"><path d="M30.75 94.9594V55.3534L57.512 30H97.2985L124.75 55.3645V94.9483L97.2871 121H57.5234L30.75 94.9594Z" stroke="#4DADAC" stroke-width="3"/></g><path d="M29.25 54.7082L56.9143 28.5H97.8854L126.25 54.7082V95.5929L97.8854 122.5H56.9143L29.25 95.5929V54.7082Z" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter1_f_140_21)"><circle cx="77.25" cy="75.5" r="22" stroke="#4DADAC" stroke-width="2"/></g><circle cx="77.25" cy="75.5" r="23" stroke="#4DADAC" stroke-width="2"/><g filter="url(#filter2_f_140_21)"><path d="M8.75 104.941V47.0592L47.4945 10H105.013L144.75 47.0703V104.93L105.001 143H47.506L8.75 104.941Z" stroke="#4DADAC" stroke-width="3"/></g><g filter="url(#filter3_d_140_21)"><mask id="path-7-outside-1_140_21" maskUnits="userSpaceOnUse" x="66.25" y="9.5" width="22" height="133" fill="black"><rect fill="white" x="66.25" y="9.5" width="22" height="133"/><path fill-rule="evenodd" clip-rule="evenodd" d="M67.25 10.5H87.25V27.3536L87.25 27.3715C87.2457 27.9176 86.804 28.3593 86.2579 28.3636L86.24 28.3636H83.25V123.62H71.25V28.3636H68.26L68.2421 28.3636C67.696 28.3593 67.2543 27.9176 67.25 27.3715L67.25 27.3536V10.5ZM67.25 124.636C67.25 124.084 67.6977 123.636 68.25 123.636H86.25C86.8023 123.636 87.25 124.084 87.25 124.636V141.5H67.25V124.636Z"/></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M67.25 10.5H87.25V27.3536L87.25 27.3715C87.2457 27.9176 86.804 28.3593 86.2579 28.3636L86.24 28.3636H83.25V123.62H71.25V28.3636H68.26L68.2421 28.3636C67.696 28.3593 67.2543 27.9176 67.25 27.3715L67.25 27.3536V10.5ZM67.25 124.636C67.25 124.084 67.6977 123.636 68.25 123.636H86.25C86.8023 123.636 87.25 124.084 87.25 124.636V141.5H67.25V124.636Z" fill="url(#paint1_linear_140_21)"/><path d="M87.25 10.5H87.75V10H87.25V10.5ZM67.25 10.5V10H66.75V10.5H67.25ZM87.25 27.3536L87.75 27.3545V27.3536H87.25ZM87.25 27.3715L87.75 27.3754L87.75 27.3723L87.25 27.3715ZM86.2579 28.3636L86.2587 28.8636L86.2618 28.8636L86.2579 28.3636ZM86.24 28.3636V28.8636H86.2409L86.24 28.3636ZM83.25 28.3636V27.8636H82.75V28.3636H83.25ZM83.25 123.62V124.12H83.75V123.62H83.25ZM71.25 123.62H70.75V124.12H71.25V123.62ZM71.25 28.3636H71.75V27.8636H71.25V28.3636ZM68.26 28.3636L68.2591 28.8636H68.26V28.3636ZM68.2421 28.3636L68.2382 28.8636L68.2413 28.8636L68.2421 28.3636ZM67.25 27.3715L66.75 27.3724L66.75 27.3754L67.25 27.3715ZM67.25 27.3536H66.75L66.75 27.3545L67.25 27.3536ZM87.25 141.5V142H87.75V141.5H87.25ZM67.25 141.5H66.75V142H67.25V141.5ZM87.25 10H67.25V11H87.25V10ZM87.75 27.3536V10.5H86.75V27.3536H87.75ZM87.75 27.3723L87.75 27.3545L86.75 27.3528L86.75 27.3706L87.75 27.3723ZM86.2618 28.8636C87.081 28.8572 87.7435 28.1946 87.75 27.3754L86.75 27.3676C86.7478 27.6406 86.527 27.8615 86.2539 27.8636L86.2618 28.8636ZM86.2409 28.8636L86.2587 28.8636L86.257 28.8636L86.2391 28.8636L86.2409 28.8636ZM83.25 28.8636H86.24V27.8636H83.25V28.8636ZM82.75 28.3636V123.62H83.75V28.3636H82.75ZM83.25 123.12H71.25V124.12H83.25V123.12ZM71.75 123.62V28.3636H70.75V123.62H71.75ZM68.26 28.8636H71.25V27.8636H68.26V28.8636ZM68.2413 28.8636L68.2591 28.8636L68.2609 27.8636L68.243 27.8636L68.2413 28.8636ZM66.75 27.3754C66.7565 28.1946 67.419 28.8572 68.2382 28.8636L68.2461 27.8636C67.973 27.8615 67.7522 27.6406 67.75 27.3676L66.75 27.3754ZM66.75 27.3545L66.75 27.3724L67.75 27.3706L67.75 27.3528L66.75 27.3545ZM66.75 10.5V27.3536H67.75V10.5H66.75ZM68.25 123.136C67.4216 123.136 66.75 123.808 66.75 124.636H67.75C67.75 124.36 67.9739 124.136 68.25 124.136V123.136ZM86.25 123.136H68.25V124.136H86.25V123.136ZM87.75 124.636C87.75 123.808 87.0784 123.136 86.25 123.136V124.136C86.5261 124.136 86.75 124.36 86.75 124.636H87.75ZM87.75 141.5V124.636H86.75V141.5H87.75ZM67.25 142H87.25V141H67.25V142ZM66.75 124.636V141.5H67.75V124.636H66.75Z" fill="#4DADAC" mask="url(#path-7-outside-1_140_21)"/></g><g filter="url(#filter4_f_140_21)"><line x1="77.3975" y1="8.99961" x2="77.5008" y2="142" stroke="#88DEB1"/></g><line x1="42.8964" y1="109.146" x2="52.8964" y2="99.1464" stroke="#4DADAC"/><circle cx="52.25" cy="99.5" r="2" fill="#4DADAC"/><line x1="77" y1="10" x2="77" y2="142" stroke="#88DEB1" stroke-width="4"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 111.25 109.5)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(-1 0 0 1 104.25 97.5)" fill="#4DADAC"/><line x1="111.604" y1="41.8536" x2="101.604" y2="51.8536" stroke="#4DADAC"/><circle cx="102.25" cy="51.5" r="2" transform="rotate(180 102.25 51.5)" fill="#4DADAC"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(0.707107 0.707107 0.707107 -0.707107 43.25 41.5)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(1 0 0 -1 50.25 53.5)" fill="#4DADAC"/><defs><filter id="filter0_f_140_21" x="25.25" y="24.5" width="105" height="102" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_21"/></filter><filter id="filter1_f_140_21" x="50.25" y="48.5" width="54" height="54" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_21"/></filter><filter id="filter2_f_140_21" x="0.85" y="2.1" width="151.8" height="148.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="3.2" result="effect1_foregroundBlur_140_21"/></filter><filter id="filter3_d_140_21" x="62.75" y="6" width="29" height="140" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix type="matrix" values="0 0 0 0 0.301961 0 0 0 0 0.678431 0 0 0 0 0.67451 0 0 0 1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_140_21"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_140_21" result="shape"/></filter><filter id="filter4_f_140_21" x="68.4975" y="0.599268" width="17.9033" height="149.801" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="4.2" result="effect1_foregroundBlur_140_21"/></filter><radialGradient id="paint0_radial_140_21" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(76.25 76.5) rotate(90) scale(239 244.272)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient><linearGradient id="paint1_linear_140_21" x1="87.25" y1="29.8523" x2="62.7502" y2="30.3561" gradientUnits="userSpaceOnUse"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></linearGradient></defs></svg>`)}`;

        const angleCableSVG = `data:image/svg+xml;base64,${btoa(`<svg width="151" height="150" viewBox="0 0 151 150" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M142.5 102.806V44.6892L104.387 7.5H47.835L8.74585 44.7003V102.795L47.8464 140.998H104.376L142.5 102.806Z" fill="url(#paint0_radial_140_48)" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter0_f_140_48)"><path d="M120.609 93.2891V53.5157L94.2859 28.0752H55.1786L28.1768 53.5268V93.2781L55.1901 119.42H94.2743L120.609 93.2891Z" stroke="#4DADAC" stroke-width="3"/></g><path d="M122.109 52.8794L94.8922 26.5752H54.5831L26.6768 52.8794V93.9139L54.5831 120.92H94.8922L122.109 93.9139V52.8794Z" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter1_f_140_48)"><path d="M53.2566 73.7473C53.2566 85.963 62.9586 95.8316 74.8849 95.8316C86.8112 95.8316 96.5133 85.963 96.5133 73.7473C96.5133 61.5316 86.8112 51.6631 74.8849 51.6631C62.9586 51.6631 53.2566 61.5316 53.2566 73.7473Z" stroke="#4DADAC" stroke-width="2"/></g><ellipse cx="22.6284" cy="23.0842" rx="22.6284" ry="23.0842" transform="matrix(-1 0 0 1 97.5133 50.6631)" stroke="#4DADAC" stroke-width="2"/><g filter="url(#filter2_f_140_48)"><path d="M142.254 103.308V45.1912L104.141 8.00195H47.5891L8.5 45.2023V103.297L47.6006 141.5H104.13L142.254 103.308Z" stroke="#4DADAC" stroke-width="3"/></g><g filter="url(#filter3_d_140_48)"><mask id="path-7-inside-1_140_48" fill="white"><path fill-rule="evenodd" clip-rule="evenodd" d="M83.9999 8H64.323V24.9191L64.3231 24.9369C64.3274 25.4831 64.769 25.9247 65.3152 25.929L65.333 25.9291H67.9999V69.0001H27.9999V66C27.9999 65.4477 27.5522 65 26.9999 65H9.99988V85H26.9999C27.5522 85 27.9999 84.5523 27.9999 84V81.0001H76.9999V81H79.9999V25.9291H82.9899L83.0077 25.929C83.5539 25.9247 83.9956 25.4831 83.9998 24.9369L83.9999 24.9191V8Z"/></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M83.9999 8H64.323V24.9191L64.3231 24.9369C64.3274 25.4831 64.769 25.9247 65.3152 25.929L65.333 25.9291H67.9999V69.0001H27.9999V66C27.9999 65.4477 27.5522 65 26.9999 65H9.99988V85H26.9999C27.5522 85 27.9999 84.5523 27.9999 84V81.0001H76.9999V81H79.9999V25.9291H82.9899L83.0077 25.929C83.5539 25.9247 83.9956 25.4831 83.9998 24.9369L83.9999 24.9191V8Z" fill="url(#paint1_radial_140_48)"/><path d="M64.323 8H63.823V7.5H64.323V8ZM83.9999 8V7.5H84.4999V8H83.9999ZM64.323 24.9191L63.823 24.9199V24.9191H64.323ZM64.3231 24.9369L63.8231 24.9409L63.8231 24.9378L64.3231 24.9369ZM65.3152 25.929L65.3143 26.429L65.3113 26.429L65.3152 25.929ZM65.333 25.9291V26.4291H65.3322L65.333 25.9291ZM67.9999 25.9291V25.4291H68.4999V25.9291H67.9999ZM67.9999 69.0001H68.4999V69.5001H67.9999V69.0001ZM27.9999 69.0001V69.5001H27.4999V69.0001H27.9999ZM9.99988 65H9.49988V64.5H9.99988V65ZM9.99988 85V85.5H9.49988V85H9.99988ZM27.9999 81.0001H27.4999V80.5001H27.9999V81.0001ZM76.9999 81.0001H77.4999V81.5001H76.9999V81.0001ZM76.9999 81H76.4999V80.5H76.9999V81ZM79.9999 81H80.4999V81.5H79.9999V81ZM79.9999 25.9291H79.4999V25.4291H79.9999V25.9291ZM82.9899 25.9291L82.9907 26.4291H82.9899V25.9291ZM83.0077 25.929L83.0117 26.429L83.0086 26.429L83.0077 25.929ZM83.9998 24.9369L84.4999 24.9378L84.4998 24.9409L83.9998 24.9369ZM83.9999 24.9191H84.4999L84.4999 24.9199L83.9999 24.9191ZM64.323 7.5H83.9999V8.5H64.323V7.5ZM63.823 24.9191V8H64.823V24.9191H63.823ZM63.8231 24.9378L63.823 24.9199L64.823 24.9182L64.8231 24.9361L63.8231 24.9378ZM65.3113 26.429C64.492 26.4226 63.8295 25.7601 63.8231 24.9409L64.8231 24.933C64.8252 25.2061 65.046 25.4269 65.3191 25.4291L65.3113 26.429ZM65.3322 26.4291L65.3143 26.429L65.316 25.429L65.3339 25.4291L65.3322 26.4291ZM67.9999 26.4291H65.333V25.4291H67.9999V26.4291ZM67.4999 69.0001V25.9291H68.4999V69.0001H67.4999ZM27.9999 68.5001H67.9999V69.5001H27.9999V68.5001ZM28.4999 66V69.0001H27.4999V66H28.4999ZM26.9999 64.5C27.8283 64.5 28.4999 65.1716 28.4999 66H27.4999C27.4999 65.7239 27.276 65.5 26.9999 65.5V64.5ZM9.99988 64.5H26.9999V65.5H9.99988V64.5ZM9.49988 85V65H10.4999V85H9.49988ZM26.9999 85.5H9.99988V84.5H26.9999V85.5ZM28.4999 84C28.4999 84.8284 27.8283 85.5 26.9999 85.5V84.5C27.276 84.5 27.4999 84.2761 27.4999 84H28.4999ZM28.4999 81.0001V84H27.4999V81.0001H28.4999ZM76.9999 81.5001H27.9999V80.5001H76.9999V81.5001ZM77.4999 81V81.0001H76.4999V81H77.4999ZM79.9999 81.5H76.9999V80.5H79.9999V81.5ZM80.4999 25.9291V81H79.4999V25.9291H80.4999ZM82.9899 26.4291H79.9999V25.4291H82.9899V26.4291ZM83.0086 26.429L82.9907 26.4291L82.989 25.4291L83.0069 25.429L83.0086 26.429ZM84.4998 24.9409C84.4934 25.7601 83.8309 26.4226 83.0117 26.429L83.0038 25.4291C83.2769 25.4269 83.4977 25.2061 83.4999 24.933L84.4998 24.9409ZM84.4999 24.9199L84.4998 24.9378L83.4998 24.9361L83.4999 24.9182L84.4999 24.9199ZM84.4999 8V24.9191H83.4999V8H84.4999Z" fill="#4DADAC" mask="url(#path-7-inside-1_140_48)"/></g><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(-0.70002 -0.714123 -0.70002 0.714123 108.336 107.872)" stroke="#4DADAC"/><ellipse cx="1.96768" cy="2.00733" rx="1.96768" ry="2.00733" transform="matrix(-1 0 0 1 101.449 95.8279)" fill="#4DADAC"/><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(0.70002 -0.714123 0.70002 0.714123 41.4343 107.872)" stroke="#4DADAC"/><ellipse cx="50.2889" cy="97.8352" rx="1.96768" ry="2.00733" fill="#4DADAC"/><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(0.70002 0.714123 0.70002 -0.714123 41.4343 39.6228)" stroke="#4DADAC"/><ellipse cx="1.96768" cy="2.00733" rx="1.96768" ry="2.00733" transform="matrix(1 0 0 -1 48.3212 51.6667)" fill="#4DADAC"/><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(-0.70002 0.714123 -0.70002 -0.714123 108.336 39.6228)" stroke="#4DADAC"/><ellipse cx="99.4809" cy="49.6594" rx="1.96768" ry="2.00733" transform="rotate(180 99.4809 49.6594)" fill="#4DADAC"/><path fill-rule="evenodd" clip-rule="evenodd" d="M76 75.9853V77H10V73H72V8H76V73V75.9853Z" fill="#88DEB1"/><defs><filter id="filter0_f_140_48" x="22.6769" y="22.5752" width="103.433" height="102.344" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_48"/></filter><filter id="filter1_f_140_48" x="48.2566" y="46.6631" width="53.2567" height="54.1685" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_48"/></filter><filter id="filter2_f_140_48" x="0.6" y="0.101953" width="149.554" height="149.298" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="3.2" result="effect1_foregroundBlur_140_48"/></filter><filter id="filter3_d_140_48" x="5.99988" y="4" width="82" height="85" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_140_48"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_140_48" result="shape"/></filter><radialGradient id="paint0_radial_140_48" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(75.8688 74.7509) rotate(90) scale(239.875 240.325)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient><radialGradient id="paint1_radial_140_48" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(52.4999 49.5) rotate(40.2852) scale(68.8222 66.1409)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient></defs></svg>`)}`;

        // Encodage des SVG OFF en base64
        // Utilisez directement le contenu des fichiers SVG que vous avez fournis
        const horizontalOFFCableSVG = `data:image/svg+xml;base64,${btoa(`<svg width="149" height="153" viewBox="0 0 149 153" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M46.5587 8.5H104.441L141.5 47.2445V104.763L104.43 144.5H46.5697L8.5 104.751V47.256L46.5587 8.5Z" fill="url(#paint0_radial_140_215)" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter0_f_140_215)"><path d="M56.0406 30.75H95.6466L121 57.512V97.2985L95.6355 124.75H56.0517L30 97.2871V57.5234L56.0406 30.75Z" stroke="#4DADAC" stroke-width="3"/></g><path d="M96.2918 29.25L122.5 56.9143V97.8854L96.2918 126.25H55.4071L28.5 97.8854V56.9143L55.4071 29.25H96.2918Z" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter1_f_140_215)"><circle cx="75.5" cy="77.25" r="22" transform="rotate(90 75.5 77.25)" stroke="#4DADAC" stroke-width="2"/></g><circle cx="75.5" cy="77.25" r="23" transform="rotate(90 75.5 77.25)" stroke="#4DADAC" stroke-width="2"/><g filter="url(#filter2_f_140_215)"><path d="M46.0587 8.75H103.941L141 47.4945V105.013L103.93 144.75H46.0697L8 105.001V47.506L46.0587 8.75Z" stroke="#4DADAC" stroke-width="3"/></g><g filter="url(#filter3_d_140_215)"><mask id="path-7-outside-1_140_215" maskUnits="userSpaceOnUse" x="8.5" y="66.25" width="133" height="22" fill="black"><rect fill="white" x="8.5" y="66.25" width="133" height="22"/><path fill-rule="evenodd" clip-rule="evenodd" d="M140.5 67.25V87.25H123.646L123.629 87.25C123.082 87.2457 122.641 86.804 122.636 86.2579L122.636 86.24V83.25H27.3805V71.25H122.636V68.26L122.636 68.2421C122.641 67.696 123.082 67.2543 123.629 67.25L123.646 67.25H140.5ZM26.3636 67.25C26.9159 67.25 27.3636 67.6977 27.3636 68.25V86.25C27.3636 86.8023 26.9159 87.25 26.3636 87.25H9.50002V67.25H26.3636Z"/></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M140.5 67.25V87.25H123.646L123.629 87.25C123.082 87.2457 122.641 86.804 122.636 86.2579L122.636 86.24V83.25H27.3805V71.25H122.636V68.26L122.636 68.2421C122.641 67.696 123.082 67.2543 123.629 67.25L123.646 67.25H140.5ZM26.3636 67.25C26.9159 67.25 27.3636 67.6977 27.3636 68.25V86.25C27.3636 86.8023 26.9159 87.25 26.3636 87.25H9.50002V67.25H26.3636Z" fill="url(#paint1_linear_140_215)"/><path d="M140.5 87.25V87.75H141V87.25H140.5ZM140.5 67.25H141V66.75H140.5V67.25ZM123.646 87.25L123.646 87.75H123.646V87.25ZM123.629 87.25L123.625 87.75L123.628 87.75L123.629 87.25ZM122.636 86.2579L122.136 86.2587L122.136 86.2618L122.636 86.2579ZM122.636 86.24H122.136V86.2409L122.636 86.24ZM122.636 83.25H123.136V82.75H122.636V83.25ZM27.3805 83.25H26.8805V83.75H27.3805V83.25ZM27.3805 71.25V70.75H26.8805V71.25H27.3805ZM122.636 71.25V71.75H123.136V71.25H122.636ZM122.636 68.26L122.136 68.2591V68.26H122.636ZM122.636 68.2421L122.136 68.2382L122.136 68.2413L122.636 68.2421ZM123.629 67.25L123.628 66.75L123.625 66.75L123.629 67.25ZM123.646 67.25V66.75L123.646 66.75L123.646 67.25ZM9.50002 87.25H9.00002V87.75H9.50002V87.25ZM9.50002 67.25V66.75H9.00002V67.25H9.50002ZM141 87.25V67.25H140V87.25H141ZM123.646 87.75H140.5V86.75H123.646V87.75ZM123.628 87.75L123.646 87.75L123.647 86.75L123.629 86.75L123.628 87.75ZM122.136 86.2618C122.143 87.081 122.805 87.7435 123.625 87.75L123.632 86.75C123.359 86.7478 123.139 86.527 123.136 86.2539L122.136 86.2618ZM122.136 86.2409L122.136 86.2587L123.136 86.257L123.136 86.2391L122.136 86.2409ZM122.136 83.25V86.24H123.136V83.25H122.136ZM122.636 82.75H27.3805V83.75H122.636V82.75ZM27.8805 83.25V71.25H26.8805V83.25H27.8805ZM27.3805 71.75H122.636V70.75H27.3805V71.75ZM122.136 68.26V71.25H123.136V68.26H122.136ZM122.136 68.2413L122.136 68.2591L123.136 68.2609L123.136 68.243L122.136 68.2413ZM123.625 66.75C122.805 66.7565 122.143 67.419 122.136 68.2382L123.136 68.2461C123.139 67.973 123.359 67.7522 123.632 67.75L123.625 66.75ZM123.646 66.75L123.628 66.75L123.629 67.75L123.647 67.75L123.646 66.75ZM140.5 66.75H123.646V67.75H140.5V66.75ZM27.8636 68.25C27.8636 67.4216 27.1921 66.75 26.3636 66.75V67.75C26.6398 67.75 26.8636 67.9739 26.8636 68.25H27.8636ZM27.8636 86.25V68.25H26.8636V86.25H27.8636ZM26.3636 87.75C27.1921 87.75 27.8636 87.0784 27.8636 86.25H26.8636C26.8636 86.5261 26.6398 86.75 26.3636 86.75V87.75ZM9.50002 87.75H26.3636V86.75H9.50002V87.75ZM9.00002 67.25V87.25H10V67.25H9.00002ZM26.3636 66.75H9.50002V67.75H26.3636V66.75Z" fill="#4DADAC" mask="url(#path-7-outside-1_140_215)"/></g><line x1="41.8536" y1="42.8964" x2="51.8536" y2="52.8964" stroke="#4DADAC"/><circle cx="51.5" cy="52.25" r="2" transform="rotate(90 51.5 52.25)" fill="#4DADAC"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(0.707107 -0.707107 -0.707107 -0.707107 41.5 111.25)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(0 -1 -1 0 53.5 104.25)" fill="#4DADAC"/><line x1="109.146" y1="111.604" x2="99.1464" y2="101.604" stroke="#4DADAC"/><circle cx="99.5" cy="102.25" r="2" transform="rotate(-90 99.5 102.25)" fill="#4DADAC"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(-0.707107 0.707107 0.707107 0.707107 109.5 43.25)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(0 1 1 0 97.5 50.25)" fill="#4DADAC"/><defs><filter id="filter0_f_140_215" x="24.5" y="25.25" width="102" height="105" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_215"/></filter><filter id="filter1_f_140_215" x="48.5" y="50.25" width="54" height="54" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_140_215"/></filter><filter id="filter2_f_140_215" x="0.0999999" y="0.85" width="148.8" height="151.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="3.2" result="effect1_foregroundBlur_140_215"/></filter><filter id="filter3_d_140_215" x="5" y="62.75" width="140" height="29" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix type="matrix" values="0 0 0 0 0.301961 0 0 0 0 0.678431 0 0 0 0 0.67451 0 0 0 1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_140_215"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_140_215" result="shape"/></filter><radialGradient id="paint0_radial_140_215" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(74.5 76.25) rotate(180) scale(239 244.272)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient><linearGradient id="paint1_linear_140_215" x1="121.148" y1="87.25" x2="120.644" y2="62.7502" gradientUnits="userSpaceOnUse"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></linearGradient></defs></svg>`)}`;

        const verticalOFFCableSVG = `data:image/svg+xml;base64,${btoa(`<svg width="153" height="149" viewBox="0 0 153 149" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 102.441V44.5592L47.2445 7.5H104.763L144.5 44.5703V102.43L104.751 140.5H47.256L8.5 102.441Z" fill="url(#paint0_radial_63_108)" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter0_f_63_108)"><path d="M30.75 92.9594V53.3534L57.512 28H97.2985L124.75 53.3645V92.9483L97.2871 119H57.5234L30.75 92.9594Z" stroke="#4DADAC" stroke-width="3"/></g><path d="M29.25 52.7082L56.9143 26.5H97.8854L126.25 52.7082V93.5929L97.8854 120.5H56.9143L29.25 93.5929V52.7082Z" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter1_f_63_108)"><circle cx="77.25" cy="73.5" r="22" stroke="#4DADAC" stroke-width="2"/></g><circle cx="77.25" cy="73.5" r="23" stroke="#4DADAC" stroke-width="2"/><g filter="url(#filter2_f_63_108)"><path d="M8.75 102.941V45.0592L47.4945 8H105.013L144.75 45.0703V102.93L105.001 141H47.506L8.75 102.941Z" stroke="#4DADAC" stroke-width="3"/></g><g filter="url(#filter3_d_63_108)"><mask id="path-7-outside-1_63_108" maskUnits="userSpaceOnUse" x="66.25" y="7.5" width="22" height="133" fill="black"><rect fill="white" x="66.25" y="7.5" width="22" height="133"/><path fill-rule="evenodd" clip-rule="evenodd" d="M67.25 8.5H87.25V25.3536L87.25 25.3715C87.2457 25.9176 86.804 26.3593 86.2579 26.3636L86.24 26.3636H83.25V121.62H71.25V26.3636H68.26L68.2421 26.3636C67.696 26.3593 67.2543 25.9176 67.25 25.3715L67.25 25.3536V8.5ZM67.25 122.636C67.25 122.084 67.6977 121.636 68.25 121.636H86.25C86.8023 121.636 87.25 122.084 87.25 122.636V139.5H67.25V122.636Z"/></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M67.25 8.5H87.25V25.3536L87.25 25.3715C87.2457 25.9176 86.804 26.3593 86.2579 26.3636L86.24 26.3636H83.25V121.62H71.25V26.3636H68.26L68.2421 26.3636C67.696 26.3593 67.2543 25.9176 67.25 25.3715L67.25 25.3536V8.5ZM67.25 122.636C67.25 122.084 67.6977 121.636 68.25 121.636H86.25C86.8023 121.636 87.25 122.084 87.25 122.636V139.5H67.25V122.636Z" fill="url(#paint1_linear_63_108)"/><path d="M87.25 8.5H87.75V8H87.25V8.5ZM67.25 8.5V8H66.75V8.5H67.25ZM87.25 25.3536L87.75 25.3545V25.3536H87.25ZM87.25 25.3715L87.75 25.3754L87.75 25.3723L87.25 25.3715ZM86.2579 26.3636L86.2587 26.8636L86.2618 26.8636L86.2579 26.3636ZM86.24 26.3636V26.8636H86.2409L86.24 26.3636ZM83.25 26.3636V25.8636H82.75V26.3636H83.25ZM83.25 121.62V122.12H83.75V121.62H83.25ZM71.25 121.62H70.75V122.12H71.25V121.62ZM71.25 26.3636H71.75V25.8636H71.25V26.3636ZM68.26 26.3636L68.2591 26.8636H68.26V26.3636ZM68.2421 26.3636L68.2382 26.8636L68.2413 26.8636L68.2421 26.3636ZM67.25 25.3715L66.75 25.3724L66.75 25.3754L67.25 25.3715ZM67.25 25.3536H66.75L66.75 25.3545L67.25 25.3536ZM87.25 139.5V140H87.75V139.5H87.25ZM67.25 139.5H66.75V140H67.25V139.5ZM87.25 8H67.25V9H87.25V8ZM87.75 25.3536V8.5H86.75V25.3536H87.75ZM87.75 25.3723L87.75 25.3545L86.75 25.3528L86.75 25.3706L87.75 25.3723ZM86.2618 26.8636C87.081 26.8572 87.7435 26.1946 87.75 25.3754L86.75 25.3676C86.7478 25.6406 86.527 25.8615 86.2539 25.8636L86.2618 26.8636ZM86.2409 26.8636L86.2587 26.8636L86.257 25.8636L86.2391 25.8636L86.2409 26.8636ZM83.25 26.8636H86.24V25.8636H83.25V26.8636ZM82.75 26.3636V121.62H83.75V26.3636H82.75ZM83.25 121.12H71.25V122.12H83.25V121.12ZM71.75 121.62V26.3636H70.75V121.62H71.75ZM68.26 26.8636H71.25V25.8636H68.26V26.8636ZM68.2413 26.8636L68.2591 26.8636L68.2609 25.8636L68.243 25.8636L68.2413 26.8636ZM66.75 25.3754C66.7565 26.1946 67.419 26.8572 68.2382 26.8636L68.2461 25.8636C67.973 25.8615 67.7522 25.6406 67.75 25.3676L66.75 25.3754ZM66.75 25.3545L66.75 25.3724L67.75 25.3706L67.75 25.3528L66.75 25.3545ZM66.75 8.5V25.3536H67.75V8.5H66.75ZM68.25 121.136C67.4216 121.136 66.75 121.808 66.75 122.636H67.75C67.75 122.36 67.9739 122.136 68.25 122.136V121.136ZM86.25 121.136H68.25V122.136H86.25V121.136ZM87.75 122.636C87.75 121.808 87.0784 121.136 86.25 121.136V122.136C86.5261 122.136 86.75 122.36 86.75 122.636H87.75ZM87.75 139.5V122.636H86.75V139.5H87.75ZM67.25 140H87.25V139H67.25V140ZM66.75 122.636V139.5H67.75V122.636H66.75Z" fill="#4DADAC" mask="url(#path-7-outside-1_63_108)"/></g><line x1="42.8964" y1="107.146" x2="52.8964" y2="97.1464" stroke="#4DADAC"/><circle cx="52.25" cy="97.5" r="2" fill="#4DADAC"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 111.25 107.5)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(-1 0 0 1 104.25 95.5)" fill="#4DADAC"/><line x1="111.604" y1="39.8536" x2="101.604" y2="49.8536" stroke="#4DADAC"/><circle cx="102.25" cy="49.5" r="2" transform="rotate(180 102.25 49.5)" fill="#4DADAC"/><line y1="-0.5" x2="14.1421" y2="-0.5" transform="matrix(0.707107 0.707107 0.707107 -0.707107 43.25 39.5)" stroke="#4DADAC"/><circle cx="2" cy="2" r="2" transform="matrix(1 0 0 -1 50.25 51.5)" fill="#4DADAC"/><defs><filter id="filter0_f_63_108" x="25.25" y="22.5" width="105" height="102" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_63_108"/></filter><filter id="filter1_f_63_108" x="50.25" y="46.5" width="54" height="54" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_63_108"/></filter><filter id="filter2_f_63_108" x="0.85" y="0.0999999" width="151.8" height="148.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="3.2" result="effect1_foregroundBlur_63_108"/></filter><filter id="filter3_d_63_108" x="62.75" y="4" width="29" height="140" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix type="matrix" values="0 0 0 0 0.301961 0 0 0 0 0.678431 0 0 0 0 0.67451 0 0 0 1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_63_108"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_63_108" result="shape"/></filter><radialGradient id="paint0_radial_63_108" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(76.25 74.5) rotate(90) scale(239 244.272)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient><linearGradient id="paint1_linear_63_108" x1="87.25" y1="27.8523" x2="62.7502" y2="28.3561" gradientUnits="userSpaceOnUse"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></linearGradient></defs></svg>`)}`;

        const angleOFFCableSVG = `data:image/svg+xml;base64,${btoa(`<svg width="151" height="150" viewBox="0 0 151 150" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M142.5 102.806V44.6892L104.387 7.5H47.835L8.74585 44.7003V102.795L47.8464 140.998H104.376L142.5 102.806Z" fill="url(#paint0_radial_125_85)" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter0_f_125_85)"><path d="M120.609 93.2891V53.5157L94.2859 28.0752H55.1786L28.1768 53.5268V93.2781L55.1901 119.42H94.2743L120.609 93.2891Z" stroke="#4DADAC" stroke-width="3"/></g><path d="M122.109 52.8794L94.8922 26.5752H54.5831L26.6768 52.8794V93.9139L54.5831 120.92H94.8922L122.109 93.9139V52.8794Z" stroke="#4DADAC" stroke-width="3"/><g filter="url(#filter1_f_125_85)"><path d="M53.2566 73.7473C53.2566 85.963 62.9586 95.8316 74.8849 95.8316C86.8112 95.8316 96.5133 85.963 96.5133 73.7473C96.5133 61.5316 86.8112 51.6631 74.8849 51.6631C62.9586 51.6631 53.2566 61.5316 53.2566 73.7473Z" stroke="#4DADAC" stroke-width="2"/></g><ellipse cx="22.6284" cy="23.0842" rx="22.6284" ry="23.0842" transform="matrix(-1 0 0 1 97.5133 50.6631)" stroke="#4DADAC" stroke-width="2"/><g filter="url(#filter2_f_125_85)"><path d="M142.254 103.308V45.1912L104.141 8.00195H47.5891L8.5 45.2023V103.297L47.6006 141.5H104.13L142.254 103.308Z" stroke="#4DADAC" stroke-width="3"/></g><g filter="url(#filter3_d_125_85)"><mask id="path-7-inside-1_125_85" fill="white"><path fill-rule="evenodd" clip-rule="evenodd" d="M83.9999 8H64.323V24.9191L64.3231 24.9369C64.3274 25.4831 64.769 25.9247 65.3152 25.929L65.333 25.9291H67.9999V69.0001H27.9999V66C27.9999 65.4477 27.5522 65 26.9999 65H9.99988V85H26.9999C27.5522 85 27.9999 84.5523 27.9999 84V81.0001H76.9999V81H79.9999V25.9291H82.9899L83.0077 25.929C83.5539 25.9247 83.9956 25.4831 83.9998 24.9369L83.9999 24.9191V8Z"/></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M83.9999 8H64.323V24.9191L64.3231 24.9369C64.3274 25.4831 64.769 25.9247 65.3152 25.929L65.333 25.9291H67.9999V69.0001H27.9999V66C27.9999 65.4477 27.5522 65 26.9999 65H9.99988V85H26.9999C27.5522 85 27.9999 84.5523 27.9999 84V81.0001H76.9999V81H79.9999V25.9291H82.9899L83.0077 25.929C83.5539 25.9247 83.9956 25.4831 83.9998 24.9369L83.9999 24.9191V8Z" fill="url(#paint1_radial_125_85)"/><path d="M64.323 8H63.823V7.5H64.323V8ZM83.9999 8V7.5H84.4999V8H83.9999ZM64.323 24.9191L63.823 24.9199V24.9191H64.323ZM64.3231 24.9369L63.8231 24.9409L63.8231 24.9378L64.3231 24.9369ZM65.3152 25.929L65.3143 26.429L65.3113 26.429L65.3152 25.929ZM65.333 25.9291V26.4291H65.3322L65.333 25.9291ZM67.9999 25.9291V25.4291H68.4999V25.9291H67.9999ZM67.9999 69.0001H68.4999V69.5001H67.9999V69.0001ZM27.9999 69.0001V69.5001H27.4999V69.0001H27.9999ZM9.99988 65H9.49988V64.5H9.99988V65ZM9.99988 85V85.5H9.49988V85H9.99988ZM27.9999 81.0001H27.4999V80.5001H27.9999V81.0001ZM76.9999 81.0001H77.4999V81.5001H76.9999V81.0001ZM76.9999 81H76.4999V80.5H76.9999V81ZM79.9999 81H80.4999V81.5H79.9999V81ZM79.9999 25.9291H79.4999V25.4291H79.9999V25.9291ZM82.9899 25.9291L82.9907 26.4291H82.9899V25.9291ZM83.0077 25.929L83.0117 26.429L83.0086 26.429L83.0077 25.929ZM83.9998 24.9369L84.4999 24.9378L84.4998 24.9409L83.9998 24.9369ZM83.9999 24.9191H84.4999L84.4999 24.9199L83.9999 24.9191ZM64.323 7.5H83.9999V8.5H64.323V7.5ZM63.823 24.9191V8H64.823V24.9191H63.823ZM63.8231 24.9378L63.823 24.9199L64.823 24.9182L64.8231 24.9361L63.8231 24.9378ZM65.3113 26.429C64.492 26.4226 63.8295 25.7601 63.8231 24.9409L64.8231 24.933C64.8252 25.2061 65.046 25.4269 65.3191 25.4291L65.3113 26.429ZM65.3322 26.4291L65.3143 26.429L65.316 25.429L65.3339 25.4291L65.3322 26.4291ZM67.9999 26.4291H65.333V25.4291H67.9999V26.4291ZM67.4999 69.0001V25.9291H68.4999V69.0001H67.4999ZM27.9999 68.5001H67.9999V69.5001H27.9999V68.5001ZM28.4999 66V69.0001H27.4999V66H28.4999ZM26.9999 64.5C27.8283 64.5 28.4999 65.1716 28.4999 66H27.4999C27.4999 65.7239 27.276 65.5 26.9999 65.5V64.5ZM9.99988 64.5H26.9999V65.5H9.99988V64.5ZM9.49988 85V65H10.4999V85H9.49988ZM26.9999 85.5H9.99988V84.5H26.9999V85.5ZM28.4999 84C28.4999 84.8284 27.8283 85.5 26.9999 85.5V84.5C27.276 84.5 27.4999 84.2761 27.4999 84H28.4999ZM28.4999 81.0001V84H27.4999V81.0001H28.4999ZM76.9999 81.5001H27.9999V80.5001H76.9999V81.5001ZM77.4999 81V81.0001H76.4999V81H77.4999ZM79.9999 81.5H76.9999V80.5H79.9999V81.5ZM80.4999 25.9291V81H79.4999V25.9291H80.4999ZM82.9899 26.4291H79.9999V25.4291H82.9899V26.4291ZM83.0086 26.429L82.9907 26.4291L82.989 25.4291L83.0069 25.429L83.0086 26.429ZM84.4998 24.9409C84.4934 25.7601 83.8309 26.4226 83.0117 26.429L83.0038 25.4291C83.2769 25.4269 83.4977 25.2061 83.4999 24.933L84.4998 24.9409ZM84.4999 24.9199L84.4998 24.9378L83.4998 24.9361L83.4999 24.9182L84.4999 24.9199ZM84.4999 8V24.9191H83.4999V8H84.4999Z" fill="#4DADAC" mask="url(#path-7-inside-1_125_85)"/></g><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(-0.70002 -0.714123 -0.70002 0.714123 108.336 107.872)" stroke="#4DADAC"/><ellipse cx="1.96768" cy="2.00733" rx="1.96768" ry="2.00733" transform="matrix(-1 0 0 1 101.449 95.8279)" fill="#4DADAC"/><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(0.70002 -0.714123 0.70002 0.714123 41.4343 107.872)" stroke="#4DADAC"/><ellipse cx="50.2889" cy="97.8352" rx="1.96768" ry="2.00733" fill="#4DADAC"/><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(0.70002 0.714123 0.70002 -0.714123 41.4343 39.6228)" stroke="#4DADAC"/><ellipse cx="1.96768" cy="2.00733" rx="1.96768" ry="2.00733" transform="matrix(1 0 0 -1 48.3212 51.6667)" fill="#4DADAC"/><line y1="-0.5" x2="14.0545" y2="-0.5" transform="matrix(-0.70002 0.714123 -0.70002 -0.714123 108.336 39.6228)" stroke="#4DADAC"/><ellipse cx="99.4809" cy="49.6594" rx="1.96768" ry="2.00733" transform="rotate(180 99.4809 49.6594)" fill="#4DADAC"/><defs><filter id="filter0_f_125_85" x="22.6769" y="22.5752" width="103.433" height="102.344" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_125_85"/></filter><filter id="filter1_f_125_85" x="48.2566" y="46.6631" width="53.2567" height="54.1685" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="2" result="effect1_foregroundBlur_125_85"/></filter><filter id="filter2_f_125_85" x="0.6" y="0.101953" width="149.554" height="149.298" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur stdDeviation="3.2" result="effect1_foregroundBlur_125_85"/></filter><filter id="filter3_d_125_85" x="5.99988" y="4" width="82" height="85" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_125_85"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_125_85" result="shape"/></filter><radialGradient id="paint0_radial_125_85" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(75.8688 74.7509) rotate(90) scale(239.875 240.325)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient><radialGradient id="paint1_radial_125_85" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(52.4999 49.5) rotate(40.2852) scale(68.8222 66.1409)"><stop stop-color="#0A022D"/><stop offset="1" stop-color="#210793"/></radialGradient></defs></svg>`)}`;

        // Types de câbles
        const WIRE_TYPES = {
            HORIZONTAL: 0,
            VERTICAL: 1,
            ANGLE_NE: 2,
            ANGLE_NW: 3,
            ANGLE_SE: 4,
            ANGLE_SW: 5
        };

        // Directions
        const DIRECTIONS = {
            UP: 0,
            RIGHT: 1,
            DOWN: 2,
            LEFT: 3
        };

        // Configuration
        const config = {
            rows: 5,
            cols: 5,
            batteryPos: { row: 0, col: 0 },
            shieldPos: { row: 4, col: 4 }
        };

        // État du jeu
        let gameState = {
            grid: [],
            connected: false,
            poweredCells: new Set(),
            visited: []
        };

        // Initialisation
        function initGame() {
            gameState.grid = [];
            gameState.connected = false;
            gameState.poweredCells = new Set();
            gameState.visited = Array(config.rows).fill().map(() => Array(config.cols).fill(false));

            const gridElement = document.getElementById('gameGrid');
            gridElement.innerHTML = '';

            createGuaranteedGrid();
            renderGrid();
            checkConnection();
        }

        // Crée une grille avec solution garantie
        function createGuaranteedGrid() {
            // Initialiser la grille vide
            for (let row = 0; row < config.rows; row++) {
                gameState.grid[row] = [];
                for (let col = 0; col < config.cols; col++) {
                    gameState.grid[row][col] = null;
                }
            }

            // Placer batterie et bouclier
            gameState.grid[config.batteryPos.row][config.batteryPos.col] = { type: 'battery' };
            gameState.grid[config.shieldPos.row][config.shieldPos.col] = { type: 'shield' };

            // Chemin solution testé manuellement
            const solutionPath = [
                { row: 0, col: 0 }, // Batterie
                { row: 0, col: 1, type: WIRE_TYPES.HORIZONTAL },
                { row: 0, col: 2, type: WIRE_TYPES.ANGLE_SE },
                { row: 1, col: 0, type: WIRE_TYPES.VERTICAL },
                { row: 1, col: 2, type: WIRE_TYPES.HORIZONTAL },
                { row: 2, col: 2, type: WIRE_TYPES.ANGLE_SW },
                { row: 2, col: 1, type: WIRE_TYPES.HORIZONTAL },
                { row: 2, col: 0, type: WIRE_TYPES.ANGLE_SW },
                { row: 3, col: 0, type: WIRE_TYPES.HORIZONTAL },
                { row: 4, col: 0, type: WIRE_TYPES.ANGLE_NE },
                { row: 4, col: 1, type: WIRE_TYPES.VERTICAL },
                { row: 4, col: 2, type: WIRE_TYPES.VERTICAL },
                { row: 4, col: 3, type: WIRE_TYPES.VERTICAL },
                { row: 4, col: 4 }  // Bouclier
            ];

            // Placer le chemin solution
            for (let i = 1; i < solutionPath.length - 1; i++) {
                const { row, col, type } = solutionPath[i];
                gameState.grid[row][col] = {
                    type: 'wire',
                    wireType: type,
                    rotation: 0
                };
            }

            // Remplir le reste avec des câbles aléatoires
            const angleTypes = [WIRE_TYPES.ANGLE_NE, WIRE_TYPES.ANGLE_NW, WIRE_TYPES.ANGLE_SE, WIRE_TYPES.ANGLE_SW];

            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (!gameState.grid[row][col]) {
                        const rand = Math.random();
                        let wireType;

                        if (rand < 0.4) {
                            wireType = angleTypes[Math.floor(Math.random() * angleTypes.length)];
                        } else if (rand < 0.7) {
                            wireType = WIRE_TYPES.HORIZONTAL;
                        } else {
                            wireType = WIRE_TYPES.VERTICAL;
                        }

                        gameState.grid[row][col] = {
                            type: 'wire',
                            wireType: wireType,
                            rotation: Math.floor(Math.random() * 4)
                        };
                    }
                }
            }
        }

        // Affichage de la grille
        function renderGrid() {
            const gridElement = document.getElementById('gameGrid');
            gridElement.innerHTML = '';

            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;

                    // Vérifier si la cellule est alimentée
                    const cellKey = `${row},${col}`;
                    if (gameState.poweredCells.has(cellKey)) {
                        cell.classList.add('powered');
                    }

                    const item = gameState.grid[row][col];

                    if (item.type === 'battery') {
                        cell.classList.add('battery');
                        const img = document.createElement('img');
                        img.src = '../assets/images/Battery.svg';
                        img.alt = 'Battery';
                        img.classList.add('icon');
                        cell.appendChild(img);
                    } else if (item.type === 'shield') {
                        cell.classList.add('shield');
                        const img = document.createElement('img');
                        img.src = gameState.connected ? '../assets/images/ShieldON.svg' : '../assets/images/ShieldOFF.svg';
                        img.alt = 'Shield';
                        img.classList.add('icon');
                        cell.appendChild(img);
                    } else if (item.type === 'wire') {
                        const wireDiv = document.createElement('div');
                        wireDiv.className = 'wire';

                        const displayType = getDisplayType(item);
                        const isPowered = gameState.poweredCells.has(cellKey);

                        if (displayType === WIRE_TYPES.HORIZONTAL) {
                            const img = document.createElement('img');
                            img.src = isPowered ? horizontalCableSVG : horizontalOFFCableSVG;
                            img.alt = 'Horizontal Cable';
                            wireDiv.appendChild(img);
                        } else if (displayType === WIRE_TYPES.VERTICAL) {
                            const img = document.createElement('img');
                            img.src = isPowered ? verticalCableSVG : verticalOFFCableSVG;
                            img.alt = 'Vertical Cable';
                            wireDiv.appendChild(img);
                        } else {
                            // Utilisation de l'image SVG pour les angles
                            const img = document.createElement('img');
                            img.src = isPowered ? angleCableSVG : angleOFFCableSVG;
                            img.alt = 'Angle Cable';

                            // Appliquer la rotation en fonction de l'orientation
                            let rotation = 0;
                            switch (displayType) {
                                case WIRE_TYPES.ANGLE_NE: rotation = 0; break;
                                case WIRE_TYPES.ANGLE_NW: rotation = 90; break;
                                case WIRE_TYPES.ANGLE_SW: rotation = 180; break;
                                case WIRE_TYPES.ANGLE_SE: rotation = 270; break;
                            }

                            img.style.transform = `rotate(${rotation}deg)`;
                            wireDiv.appendChild(img);
                        }

                        cell.appendChild(wireDiv);
                    }

                    cell.addEventListener('click', () => handleCellClick(row, col));
                    gridElement.appendChild(cell);
                }
            }
        }

        function getDisplayType(item) {
            if (item.wireType === WIRE_TYPES.HORIZONTAL || item.wireType === WIRE_TYPES.VERTICAL) {
                return (item.wireType + item.rotation) % 2;
            }

            const angleTypes = [WIRE_TYPES.ANGLE_NE, WIRE_TYPES.ANGLE_NW, WIRE_TYPES.ANGLE_SW, WIRE_TYPES.ANGLE_SE];
            const baseIndex = item.wireType - WIRE_TYPES.ANGLE_NE;
            return angleTypes[(baseIndex + item.rotation) % 4];
        }

        function handleCellClick(row, col) {
            const item = gameState.grid[row][col];

            if (item && item.type === 'wire') {
                item.rotation = (item.rotation + 1) % 4;
                renderGrid();
                checkConnection();
            }
        }

        function checkConnection() {
            gameState.connected = false;
            gameState.poweredCells = new Set();
            gameState.visited = Array(config.rows).fill().map(() => Array(config.cols).fill(false));

            dfs(config.batteryPos.row, config.batteryPos.col, null);

            const shieldKey = `${config.shieldPos.row},${config.shieldPos.col}`;
            gameState.connected = gameState.poweredCells.has(shieldKey);

            updateStatus();
            renderGrid();
        }

        function dfs(row, col, fromDirection) {
            const key = `${row},${col}`;

            if (row < 0 || row >= config.rows || col < 0 || col >= config.cols || gameState.visited[row][col]) {
                return;
            }

            const item = gameState.grid[row][col];
            if (!item) return;

            gameState.visited[row][col] = true;
            gameState.poweredCells.add(key);

            if (item.type === 'shield') {
                return;
            }

            if (item.type === 'battery') {
                if (canEmitToDirection(item, DIRECTIONS.DOWN)) {
                    dfs(row + 1, col, DIRECTIONS.UP);
                }
                if (canEmitToDirection(item, DIRECTIONS.RIGHT)) {
                    dfs(row, col + 1, DIRECTIONS.LEFT);
                }
                return;
            }

            const displayType = getDisplayType(item);
            const outputDirections = getOutputDirections(displayType, fromDirection);

            for (const dir of outputDirections) {
                let nextRow = row, nextCol = col, nextFromDir;

                switch (dir) {
                    case DIRECTIONS.UP:
                        nextRow--;
                        nextFromDir = DIRECTIONS.DOWN;
                        break;
                    case DIRECTIONS.RIGHT:
                        nextCol++;
                        nextFromDir = DIRECTIONS.LEFT;
                        break;
                    case DIRECTIONS.DOWN:
                        nextRow++;
                        nextFromDir = DIRECTIONS.UP;
                        break;
                    case DIRECTIONS.LEFT:
                        nextCol--;
                        nextFromDir = DIRECTIONS.RIGHT;
                        break;
                }

                if (nextRow >= 0 && nextRow < config.rows && nextCol >= 0 && nextCol < config.cols) {
                    const nextItem = gameState.grid[nextRow][nextCol];
                    if (nextItem && canReceiveFromDirection(nextItem, nextFromDir)) {
                        dfs(nextRow, nextCol, nextFromDir);
                    }
                }
            }
        }

        function canEmitToDirection(item, direction) {
            if (!item) return false;

            if (item.type === 'battery') {
                return direction === DIRECTIONS.DOWN || direction === DIRECTIONS.RIGHT;
            }
            if (item.type === 'wire') {
                const displayType = getDisplayType(item);
                return getConnections(displayType).includes(direction);
            }
            return false;
        }

        function canReceiveFromDirection(item, direction) {
            if (!item) return false;

            if (item.type === 'shield') {
                return true;
            }
            if (item.type === 'wire') {
                const displayType = getDisplayType(item);
                return getConnections(displayType).includes(direction);
            }
            return false;
        }

        function getConnections(wireType) {
            switch (wireType) {
                case WIRE_TYPES.HORIZONTAL:
                    return [DIRECTIONS.LEFT, DIRECTIONS.RIGHT];
                case WIRE_TYPES.VERTICAL:
                    return [DIRECTIONS.UP, DIRECTIONS.DOWN];
                case WIRE_TYPES.ANGLE_NE:
                    return [DIRECTIONS.LEFT, DIRECTIONS.UP];
                case WIRE_TYPES.ANGLE_NW:
                    return [DIRECTIONS.RIGHT, DIRECTIONS.UP];
                case WIRE_TYPES.ANGLE_SE:
                    return [DIRECTIONS.LEFT, DIRECTIONS.DOWN];
                case WIRE_TYPES.ANGLE_SW:
                    return [DIRECTIONS.RIGHT, DIRECTIONS.DOWN];
                default:
                    return [];
            }
        }

        function getOutputDirections(wireType, inputDirection) {
            const connections = getConnections(wireType);

            if (inputDirection === null) return connections;

            if (!connections.includes(inputDirection)) return [];

            return connections.filter(dir => dir !== inputDirection);
        }

        function updateStatus() {
            const status = document.getElementById('status');
            if (gameState.connected) {
                status.textContent = '';
                status.style.color = '#4CAF50';
                setTimeout(showEndScreen, 500);
            } else {
                status.textContent = '';
                status.style.color = 'white';
            }
        }

       
        let endScreenSound;

        function showEndScreen() {
            const endScreen = document.getElementById('endScreen');
            endScreen.classList.add('show');

            
            endScreenSound = new Audio('../assets/Sounds/SucessSoundEffect.mp3');
            endScreenSound.play().catch(e => console.error("Erreur de lecture audio:", e));
        }

        function hideEndScreen() {
            const endScreen = document.getElementById('endScreen');
            endScreen.classList.remove('show');

            // Arrêter le son si besoin
            if (endScreenSound) {
                endScreenSound.pause();
                endScreenSound.currentTime = 0;
            }
        }

        // document.getElementById('resetBtn').addEventListener('click', () => {
        //     for (let row = 0; row < config.rows; row++) {
        //         for (let col = 0; col < config.cols; col++) {
        //             const item = gameState.grid[row][col];
        //             if (item && item.type === 'wire') {
        //                 item.rotation = 0;
        //             }
        //         }
        //     }
        //     renderGrid();
        //     checkConnection();
        // });

        // document.getElementById('newGameBtn').addEventListener('click', initGame);

        initGame();
    </script>
</body>

</html>